<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estadísticas Tienda Naturista</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #8BC34A;
            --accent-color: #CDDC39;
            --dark-color: #2E7D32;
            --light-color: #E8F5E9;
            --text-color: #333;
            --light-text: #fff;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: var(--light-text);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            box-shadow: var(--box-shadow);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .date-range {
            font-style: italic;
            margin-bottom: 10px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 15px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .btn-accent {
            background-color: var(--accent-color);
            color: var(--text-color);
        }
        
        button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            text-align: center;
            transition: transform 0.3s ease;
            position: relative;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark-color);
            margin: 10px 0;
        }
        
        .stat-title {
            font-size: 1rem;
            color: #666;
        }
        
        .stat-change {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: bold;
        }
        
        .positive {
            background-color: #E8F5E9;
            color: var(--dark-color);
        }
        
        .negative {
            background-color: #FFEBEE;
            color: #C62828;
        }
        
        .view-controls {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 20px;
            gap: 10px;
        }
        
        .view-btn {
            background-color: white;
            border: 1px solid #ddd;
            padding: 8px 15px;
        }
        
        .view-btn.active {
            background-color: var(--light-color);
            border-color: var(--primary-color);
        }
        
        .charts-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
        }
        
        .chart-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--dark-color);
            text-align: center;
        }
        
        .table-section {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--light-color);
            color: var(--dark-color);
        }
        
        tr:hover {
            background-color: #f9f9f9;
        }
        
        .print-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
        }
        
        .hidden {
            display: none;
        }
        
        /* Modo de impresión */
        @media print {
            body {
                background-color: white;
                font-size: 12pt;
            }
            
            header, .controls, footer, .print-controls, .view-controls {
                display: none;
            }
            
            .stat-card, .chart-container, .table-section {
                box-shadow: none;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }
            
            .stat-card {
                break-inside: avoid;
            }
            
            .container {
                max-width: 100%;
                padding: 0;
            }
            
            h1, h2, h3 {
                color: black !important;
            }
            
            .chart-container canvas {
                max-height: 300px !important;
            }
        }
        
        /* Estilos para vista de lista */
        .list-view .stats-grid {
            grid-template-columns: 1fr;
        }
        
        .list-view .stat-card {
            display: flex;
            align-items: center;
            text-align: left;
            padding: 15px 20px;
        }
        
        .list-view .stat-card i {
            margin-bottom: 0;
            margin-right: 20px;
            font-size: 2rem;
        }
        
        .list-view .stat-content {
            flex-grow: 1;
        }
        
        .list-view .stat-value {
            font-size: 1.5rem;
            margin: 0;
        }
        
        /* Estilos para vista compacta */
        .compact-view .stats-grid {
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        }
        
        .compact-view .stat-card {
            padding: 15px;
        }
        
        .compact-view .stat-card i {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }
        
        .compact-view .stat-value {
            font-size: 1.5rem;
        }
        
        .compact-view .stat-title {
            font-size: 0.9rem;
        }
        
        /* Estilos para vista detallada */
        .detailed-view .stats-grid {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
        
        .detailed-view .stat-card {
            text-align: left;
            padding: 25px;
        }
        
        .detailed-view .stat-card i {
            margin-bottom: 20px;
        }
        
        .detailed-view .stat-value {
            font-size: 2.2rem;
        }
        
        .detailed-view .stat-description {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div>
                    <h1>Estadísticas Tienda Naturista "Vida Sana"</h1>
                    <p class="date-range">Período: 1 de Enero - 31 de Marzo 2023</p>
                </div>
                <div>
                    <i class="fas fa-leaf fa-3x"></i>
                </div>
            </div>
        </header>
        
        <div class="controls">
            <button class="btn-primary" onclick="changePeriod('month')">
                <i class="fas fa-calendar-week"></i> Mensual
            </button>
            <button class="btn-primary" onclick="changePeriod('quarter')">
                <i class="fas fa-calendar-alt"></i> Trimestral
            </button>
            <button class="btn-primary" onclick="changePeriod('year')">
                <i class="fas fa-calendar"></i> Anual
            </button>
            <button class="btn-accent" onclick="toggleComparison()">
                <i class="fas fa-chart-bar"></i> Comparar con período anterior
            </button>
        </div>
        
        <div class="view-controls">
            <button class="view-btn active" onclick="changeView('grid')">
                <i class="fas fa-th"></i> Cuadrícula
            </button>
            <button class="view-btn" onclick="changeView('list')">
                <i class="fas fa-list"></i> Lista
            </button>
            <button class="view-btn" onclick="changeView('compact')">
                <i class="fas fa-compress"></i> Compacta
            </button>
            <button class="view-btn" onclick="changeView('detailed')">
                <i class="fas fa-expand"></i> Detallada
            </button>
        </div>
        
        <div class="stats-grid" id="statsContainer">
            <div class="stat-card">
                <i class="fas fa-shopping-cart"></i>
                <div class="stat-value">$45,680</div>
                <div class="stat-title">Ventas Totales</div>
                <div class="stat-change positive">+12.5%</div>
                <div class="stat-description hidden">Ingresos brutos generados durante el período</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-chart-line"></i>
                <div class="stat-value">$28,450</div>
                <div class="stat-title">Beneficio Neto</div>
                <div class="stat-change positive">+8.3%</div>
                <div class="stat-description hidden">Beneficio después de costos y gastos</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-users"></i>
                <div class="stat-value">1,248</div>
                <div class="stat-title">Clientes Atendidos</div>
                <div class="stat-change positive">+5.2%</div>
                <div class="stat-description hidden">Clientes únicos que realizaron compras</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-box-open"></i>
                <div class="stat-value">342</div>
                <div class="stat-title">Productos Vendidos</div>
                <div class="stat-change positive">+7.8%</div>
                <div class="stat-description hidden">Unidades de productos comercializadas</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-percentage"></i>
                <div class="stat-value">42.5%</div>
                <div class="stat-title">Margen de Beneficio</div>
                <div class="stat-change positive">+2.1%</div>
                <div class="stat-description hidden">Porcentaje de beneficio sobre ventas</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-sync"></i>
                <div class="stat-value">3.2</div>
                <div class="stat-title">Rotación de Inventario</div>
                <div class="stat-change negative">-0.4</div>
                <div class="stat-description hidden">Veces que el inventario se renueva en el período</div>
            </div>
        </div>
        
        <div class="charts-section">
            <div class="chart-container">
                <h3 class="chart-title">Ventas por Categoría de Productos</h3>
                <canvas id="categoryChart"></canvas>
            </div>
            <div class="chart-container">
                <h3 class="chart-title">Tendencia de Ventas Mensual</h3>
                <canvas id="salesTrendChart"></canvas>
            </div>
            <div class="chart-container">
                <h3 class="chart-title">Distribución de Clientes por Grupo de Edad</h3>
                <canvas id="customerAgeChart"></canvas>
            </div>
            <div class="chart-container">
                <h3 class="chart-title">Comparativa de Métricas Clave</h3>
                <canvas id="metricsChart"></canvas>
            </div>
        </div>
        
        <div class="table-section">
            <h3>Productos Más Vendidos</h3>
            <table>
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Categoría</th>
                        <th>Cantidad Vendida</th>
                        <th>Ingresos</th>
                        <th>Margen</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Aceite de Coco Orgánico</td>
                        <td>Aceites Esenciales</td>
                        <td>156</td>
                        <td>$3,450</td>
                        <td>48%</td>
                    </tr>
                    <tr>
                        <td>Multivitamínico Natural</td>
                        <td>Suplementos</td>
                        <td>128</td>
                        <td>$2,890</td>
                        <td>52%</td>
                    </tr>
                    <tr>
                        <td>Té Verde Matcha</td>
                        <td>Infusiones</td>
                        <td>112</td>
                        <td>$1,780</td>
                        <td>45%</td>
                    </tr>
                    <tr>
                        <td>Semillas de Chía</td>
                        <td>Superfoods</td>
                        <td>98</td>
                        <td>$1,230</td>
                        <td>42%</td>
                    </tr>
                    <tr>
                        <td>Crema de Caléndula</td>
                        <td>Cosmética Natural</td>
                        <td>87</td>
                        <td>$1,650</td>
                        <td>55%</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="table-section">
            <h3>Análisis de Rentabilidad por Categoría</h3>
            <table>
                <thead>
                    <tr>
                        <th>Categoría</th>
                        <th>Ventas</th>
                        <th>Costos</th>
                        <th>Beneficio</th>
                        <th>Margen</th>
                        <th>Rentabilidad</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Suplementos</td>
                        <td>$15,200</td>
                        <td>$7,150</td>
                        <td>$8,050</td>
                        <td>53%</td>
                        <td>Alta</td>
                    </tr>
                    <tr>
                        <td>Aceites Esenciales</td>
                        <td>$10,850</td>
                        <td>$5,650</td>
                        <td>$5,200</td>
                        <td>48%</td>
                        <td>Media</td>
                    </tr>
                    <tr>
                        <td>Infusiones</td>
                        <td>$8,750</td>
                        <td>$4,820</td>
                        <td>$3,930</td>
                        <td>45%</td>
                        <td>Media</td>
                    </tr>
                    <tr>
                        <td>Cosmética Natural</td>
                        <td>$6,420</td>
                        <td>$2,890</td>
                        <td>$3,530</td>
                        <td>55%</td>
                        <td>Alta</td>
                    </tr>
                    <tr>
                        <td>Superfoods</td>
                        <td>$4,460</td>
                        <td>$2,580</td>
                        <td>$1,880</td>
                        <td>42%</td>
                        <td>Baja</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="print-controls">
            <button class="btn-secondary" onclick="window.print()">
                <i class="fas fa-print"></i> Imprimir Todo
            </button>
            <button class="btn-secondary" onclick="printSummary()">
                <i class="fas fa-file-alt"></i> Imprimir Resumen Ejecutivo
            </button>
            <button class="btn-secondary" onclick="printCharts()">
                <i class="fas fa-chart-bar"></i> Imprimir Solo Gráficos
            </button>
            <button class="btn-secondary" onclick="printTables()">
                <i class="fas fa-table"></i> Imprimir Solo Tablas
            </button>
        </div>
        
        <footer>
            <p>Estadísticas generadas el 15 de Abril 2023 | Tienda Naturista "Vida Sana" | Categorías: Suplementos, Aceites Esenciales, Infusiones, Superfoods, Cosmética Natural</p>
        </footer>
    </div>

    <script>
        // Datos de ejemplo para las gráficas
        const categoryData = {
            labels: ['Suplementos', 'Aceites Esenciales', 'Infusiones', 'Cosmética Natural', 'Superfoods'],
            datasets: [{
                label: 'Ventas por Categoría',
                data: [35, 25, 20, 12, 8],
                backgroundColor: [
                    '#4CAF50',
                    '#8BC34A',
                    '#CDDC39',
                    '#AED581',
                    '#C5E1A5'
                ],
                borderWidth: 1
            }]
        };
        
        const salesTrendData = {
            labels: ['Ene', 'Feb', 'Mar'],
            datasets: [{
                label: 'Ventas 2023',
                data: [14200, 15200, 16280],
                borderColor: '#4CAF50',
                backgroundColor: 'rgba(76, 175, 80, 0.1)',
                fill: true,
                tension: 0.4
            }, {
                label: 'Ventas 2022',
                data: [12500, 13800, 14500],
                borderColor: '#8BC34A',
                backgroundColor: 'rgba(139, 195, 74, 0.1)',
                fill: true,
                tension: 0.4,
                hidden: true
            }]
        };
        
        const customerAgeData = {
            labels: ['18-25', '26-35', '36-45', '46-55', '56+'],
            datasets: [{
                label: 'Distribución por Edad',
                data: [15, 28, 32, 18, 7],
                backgroundColor: [
                    '#4CAF50',
                    '#8BC34A',
                    '#CDDC39',
                    '#AED581',
                    '#C5E1A5'
                ],
                borderWidth: 1
            }]
        };
        
        const metricsData = {
            labels: ['Ventas', 'Clientes', 'Productos', 'Margen'],
            datasets: [{
                label: 'Período Actual',
                data: [85, 75, 65, 80],
                backgroundColor: 'rgba(76, 175, 80, 0.2)',
                borderColor: '#4CAF50',
                pointBackgroundColor: '#4CAF50',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#4CAF50'
            }, {
                label: 'Período Anterior',
                data: [70, 65, 60, 75],
                backgroundColor: 'rgba(139, 195, 74, 0.2)',
                borderColor: '#8BC34A',
                pointBackgroundColor: '#8BC34A',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#8BC34A'
            }]
        };
        
        // Variables de estado
        let comparisonVisible = false;
        let currentView = 'grid';
        
        // Inicializar gráficos cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            // Gráfico de categorías
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            new Chart(categoryCtx, {
                type: 'doughnut',
                data: categoryData,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        }
                    }
                }
            });
            
            // Gráfico de tendencia de ventas
            const salesTrendCtx = document.getElementById('salesTrendChart').getContext('2d');
            new Chart(salesTrendCtx, {
                type: 'line',
                data: salesTrendData,
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
            
            // Gráfico de distribución por edad
            const customerAgeCtx = document.getElementById('customerAgeChart').getContext('2d');
            new Chart(customerAgeCtx, {
                type: 'pie',
                data: customerAgeData,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        }
                    }
                }
            });
            
            // Gráfico de métricas comparativas
            const metricsCtx = document.getElementById('metricsChart').getContext('2d');
            new Chart(metricsCtx, {
                type: 'radar',
                data: metricsData,
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    }
                }
            });
        });
        
        // Función para cambiar el período de las estadísticas
        function changePeriod(period) {
            let periodText = '';
            switch(period) {
                case 'month':
                    periodText = 'Abril 2023';
                    break;
                case 'quarter':
                    periodText = '2do Trimestre 2023';
                    break;
                case 'year':
                    periodText = 'Año 2023';
                    break;
            }
            
            document.querySelector('.date-range').textContent = `Período: ${periodText}`;
            
            // En una implementación real, aquí se haría una llamada AJAX para actualizar los datos
            alert(`Cambiando a estadísticas ${periodText}. En una implementación real, los datos se actualizarían.`);
        }
        
        // Función para cambiar la vista de las estadísticas
        function changeView(view) {
            // Actualizar botones activos
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Cambiar clase del contenedor
            const container = document.getElementById('statsContainer');
            container.className = 'stats-grid';
            
            // Mostrar/ocultar descripciones según la vista
            const descriptions = document.querySelectorAll('.stat-description');
            descriptions.forEach(desc => {
                desc.classList.add('hidden');
            });
            
            // Aplicar estilos según la vista seleccionada
            if (view === 'list') {
                container.classList.add('list-view');
            } else if (view === 'compact') {
                container.classList.add('compact-view');
            } else if (view === 'detailed') {
                container.classList.add('detailed-view');
                descriptions.forEach(desc => {
                    desc.classList.remove('hidden');
                });
            }
            
            currentView = view;
        }
        
        // Función para mostrar/ocultar comparación con período anterior
        function toggleComparison() {
            comparisonVisible = !comparationVisible;
            
            if (comparationVisible) {
                event.target.innerHTML = '<i class="fas fa-chart-bar"></i> Ocultar comparación';
                // En una implementación real, aquí se mostrarían datos de comparación
                alert('Mostrando comparación con período anterior');
            } else {
                event.target.innerHTML = '<i class="fas fa-chart-bar"></i> Comparar con período anterior';
                // En una implementación real, aquí se ocultarían datos de comparación
                alert('Ocultando comparación con período anterior');
            }
        }
        
        // Función para imprimir solo el resumen ejecutivo
        function printSummary() {
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Resumen Ejecutivo - Estadísticas Tienda Naturista</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; color: #333; }
                        h1 { color: #2E7D32; text-align: center; margin-bottom: 10px; }
                        h2 { color: #2E7D32; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .period { font-style: italic; margin-bottom: 20px; }
                        .stats { display: flex; justify-content: space-around; margin: 20px 0; flex-wrap: wrap; }
                        .stat { text-align: center; margin: 10px; min-width: 150px; }
                        .stat-value { font-size: 24px; font-weight: bold; color: #2E7D32; }
                        .stat-title { font-size: 14px; color: #666; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; margin-bottom: 30px; }
                        th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
                        th { background-color: #f5f5f5; }
                        .summary { margin-top: 30px; padding: 15px; background-color: #f9f9f9; border-radius: 5px; }
                        .footer { margin-top: 30px; font-size: 12px; text-align: center; color: #666; }
                        @media print {
                            body { font-size: 12pt; }
                            .stat-value { font-size: 18pt; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Resumen Ejecutivo - Tienda Naturista "Vida Sana"</h1>
                        <p class="period"><strong>Período:</strong> 1 de Enero - 31 de Marzo 2023</p>
                    </div>
                    
                    <div class="stats">
                        <div class="stat">
                            <div class="stat-value">$45,680</div>
                            <div class="stat-title">Ventas Totales</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">$28,450</div>
                            <div class="stat-title">Beneficio Neto</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">1,248</div>
                            <div class="stat-title">Clientes Atendidos</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">42.5%</div>
                            <div class="stat-title">Margen de Beneficio</div>
                        </div>
                    </div>
                    
                    <h2>Productos Más Vendidos</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Cantidad Vendida</th>
                                <th>Ingresos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Aceite de Coco Orgánico</td>
                                <td>156</td>
                                <td>$3,450</td>
                            </tr>
                            <tr>
                                <td>Multivitamínico Natural</td>
                                <td>128</td>
                                <td>$2,890</td>
                            </tr>
                            <tr>
                                <td>Té Verde Matcha</td>
                                <td>112</td>
                                <td>$1,780</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h2>Resumen por Categorías</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Categoría</th>
                                <th>Ventas</th>
                                <th>% del Total</th>
                                <th>Rentabilidad</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Suplementos</td>
                                <td>$15,200</td>
                                <td>33.3%</td>
                                <td>Alta</td>
                            </tr>
                            <tr>
                                <td>Aceites Esenciales</td>
                                <td>$10,850</td>
                                <td>23.8%</td>
                                <td>Media</td>
                            </tr>
                            <tr>
                                <td>Infusiones</td>
                                <td>$8,750</td>
                                <td>19.2%</td>
                                <td>Media</td>
                            </tr>
                            <tr>
                                <td>Cosmética Natural</td>
                                <td>$6,420</td>
                                <td>14.1%</td>
                                <td>Alta</td>
                            </tr>
                            <tr>
                                <td>Superfoods</td>
                                <td>$4,460</td>
                                <td>9.8%</td>
                                <td>Baja</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="summary">
                        <h2>Análisis y Conclusiones</h2>
                        <p><strong>Puntos destacados:</strong></p>
                        <ul>
                            <li>Crecimiento del 12.5% en ventas respecto al trimestre anterior</li>
                            <li>Los suplementos representan la categoría más rentable con el 33.3% de las ventas</li>
                            <li>Incremento del 5.2% en la base de clientes</li>
                            <li>La cosmética natural muestra el mayor margen de beneficio (55%)</li>
                        </ul>
                        <p><strong>Recomendaciones:</strong></p>
                        <ul>
                            <li>Incrementar inventario de suplementos y productos de cosmética natural</li>
                            <li>Desarrollar estrategias para mejorar rentabilidad de la categoría Superfoods</li>
                            <li>Implementar programa de fidelización para retener clientes nuevos</li>
                        </ul>
                    </div>
                    
                    <div class="footer">
                        <p>Resumen ejecutivo generado el ${new Date().toLocaleDateString()} | Tienda Naturista "Vida Sana"</p>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        // Función para imprimir solo los gráficos
        function printCharts() {
            // Ocultar todos los elementos excepto los gráficos
            const elementsToHide = document.querySelectorAll('header, .controls, .view-controls, .stats-grid, .table-section, footer, .print-controls');
            elementsToHide.forEach(el => {
                el.style.display = 'none';
            });
            
            // Imprimir
            window.print();
            
            // Restaurar visibilidad
            setTimeout(() => {
                elementsToHide.forEach(el => {
                    el.style.display = '';
                });
            }, 500);
        }
        
        // Función para imprimir solo las tablas
        function printTables() {
            // Ocultar todos los elementos excepto las tablas
            const elementsToHide = document.querySelectorAll('header, .controls, .view-controls, .stats-grid, .charts-section, footer, .print-controls');
            elementsToHide.forEach(el => {
                el.style.display = 'none';
            });
            
            // Imprimir
            window.print();
            
            // Restaurar visibilidad
            setTimeout(() => {
                elementsToHide.forEach(el => {
                    el.style.display = '';
                });
            }, 500);
        }
    </script>
</body>
</html>